<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>prng</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Optimization common toolings</span> <span class="project-version">2.3.2</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="distribution.html"><div class="inner"><span>Distribution </span></div></a></li><li class="depth-1  current"><a href="prng.html"><div class="inner"><span>prng</span></div></a></li><li class="depth-1 "><a href="time_based.html"><div class="inner"><span>Time-based features.</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>automaton-optimization</span></div></div></li><li class="depth-2"><a href="automaton-optimization.distribution.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>distribution</span></div></a></li><li class="depth-3 branch"><a href="automaton-optimization.distribution.distribution-protocol.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>distribution-protocol</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-4 branch"><a href="automaton-optimization.distribution.impl.exponential.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exponential</span></div></a></li><li class="depth-4 branch"><a href="automaton-optimization.distribution.impl.factory.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>factory</span></div></a></li><li class="depth-4 branch"><a href="automaton-optimization.distribution.impl.kixi-stats.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kixi-stats</span></div></a></li><li class="depth-4 branch"><a href="automaton-optimization.distribution.impl.uniform.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>uniform</span></div></a></li><li class="depth-4"><a href="automaton-optimization.distribution.impl.uniform-integer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>uniform-integer</span></div></a></li><li class="depth-3"><a href="automaton-optimization.distribution.registry.html"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-2"><a href="automaton-optimization.maths.html"><div class="inner"><span class="tree" style="top: -269px;"><span class="top" style="height: 278px;"></span><span class="bottom"></span></span><span>maths</span></div></a></li><li class="depth-3"><a href="automaton-optimization.maths.gamma.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gamma</span></div></a></li><li class="depth-2"><a href="automaton-optimization.prng.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>prng</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-4 branch"><a href="automaton-optimization.prng.impl.built-in.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>built-in</span></div></a></li><li class="depth-4 branch"><a href="automaton-optimization.prng.impl.tests.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tests</span></div></a></li><li class="depth-4 branch"><a href="automaton-optimization.prng.impl.well.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>well</span></div></a></li><li class="depth-4 branch"><a href="automaton-optimization.prng.impl.well-macros.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>well-macros</span></div></a></li><li class="depth-4"><a href="automaton-optimization.prng.impl.xoroshiro128.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>xoroshiro128</span></div></a></li><li class="depth-3 branch"><a href="automaton-optimization.prng.stateful.html"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>stateful</span></div></a></li><li class="depth-3 branch"><a href="automaton-optimization.prng.stateful-wrapper.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stateful-wrapper</span></div></a></li><li class="depth-3"><a href="automaton-optimization.prng.stateless.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stateless</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -300px;"><span class="top" style="height: 309px;"></span><span class="bottom"></span></span><span>sample</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-4 branch"><a href="automaton-optimization.sample.impl.number-set.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>number-set</span></div></a></li><li class="depth-4"><a href="automaton-optimization.sample.impl.vector.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vector</span></div></a></li><li class="depth-3"><a href="automaton-optimization.sample.sample-protocol.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>sample-protocol</span></div></a></li><li class="depth-2"><a href="automaton-optimization.time-based.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>time-based</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-4 branch"><a href="automaton-optimization.time-based.impl.aggregate.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>aggregate</span></div></a></li><li class="depth-4 branch"><a href="automaton-optimization.time-based.impl.aggregates.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>aggregates</span></div></a></li><li class="depth-4 branch"><a href="automaton-optimization.time-based.impl.aggregator.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>aggregator</span></div></a></li><li class="depth-4 branch"><a href="automaton-optimization.time-based.impl.aggregator-item.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>aggregator-item</span></div></a></li><li class="depth-4"><a href="automaton-optimization.time-based.impl.storage-strategy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>storage-strategy</span></div></a></li><li class="depth-5 branch"><a href="automaton-optimization.time-based.impl.storage-strategy.contiguous.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>contiguous</span></div></a></li><li class="depth-5"><a href="automaton-optimization.time-based.impl.storage-strategy.deltas.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>deltas</span></div></a></li><li class="depth-4 branch"><a href="automaton-optimization.time-based.impl.var-additive.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>var-additive</span></div></a></li><li class="depth-4 branch"><a href="automaton-optimization.time-based.impl.var-aggregated.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>var-aggregated</span></div></a></li><li class="depth-4"><a href="automaton-optimization.time-based.impl.var-latest.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>var-latest</span></div></a></li><li class="depth-3"><a href="automaton-optimization.time-based.protocol.html"><div class="inner"><span class="tree" style="top: -331px;"><span class="top" style="height: 340px;"></span><span class="bottom"></span></span><span>protocol</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#prng" id="prng"></a>prng</h1>
<p>A <code>prng</code> is a computer ready implementation of randomness, it consists in a series of numbers which coding is the one of the platform you’re executing the prng on. There maybe multiple implementations of it and this library is agnostic from it.</p>
<ul>
<li><a href="#prng">prng</a></li>
<li><a href="#quick-start">Quick start</a></li>
<li><a href="#advanced-features">Advanced features</a></li>
<li><a href="#registry">Registry</a></li>
<li><a href="#creates-a-new-prng">Creates a new PRNG</a></li>
</ul>
<h1><a href="#quick-start" id="quick-start"></a>Quick start</h1>
<p>A <code>prng</code> can be used simply with:</p>
<pre><code class="language-clojure">(require '[automaton-optimization.prng :refer :all])

(-&gt;
 (prng {:prng-name :xoroshiro128})
 rnd)
;; 9152956147207792660
</code></pre>
<p>But if you need to set the seed, you can specify it in the parameters:</p>
<pre><code class="language-clojure">(-&gt;
 (prng {:prng-name :xoroshiro128
        :seed 123456})
 rnd)
;; -2818580778651254546
</code></pre>
<p>It is possible to draw numbers with different functions, each of it is specialized in some specific cases. Use preferably that ones when it matches your need.</p>
<pre><code class="language-clojure">(-&gt;
 (prng {:prng-name :xoroshiro128
        :seed 123456})
 (as-int 14 15))
;; 14

(-&gt;
 (prng {:prng-name :xoroshiro128
        :seed 123456})
 (draw-ints 3 10 15))
;; (14 10 12)

(-&gt;
 (prng {:prng-name :xoroshiro128
        :seed 123456})
 (draw-doubles 3 10 15))
;; (14.236022149115106 11.896873751467972 10.689053846065011)
</code></pre>
<h1><a href="#advanced-features" id="advanced-features"></a>Advanced features</h1>
<p>When you work with <code>prng</code>, the management of seed is a major concern. The <code>prng</code> feature has some helper functions to cover main use cases.</p>
<p>You can use the <code>seed</code> function to get the seed of that <code>prng</code></p>
<pre><code class="language-clojure">(-&gt;
 (prng {:prng-name :xoroshiro128})
 seed)
;; [2542600934226551889 6610355212981240771]
</code></pre>
<p>So you can reuse it to create another <code>prng</code>, so both of are drawing the same numbers in the same order:</p>
<pre><code class="language-clojure">(def p (prng {:prng-name :xoroshiro128}))

(def s (seed p))
;; [2542600934226551889 6610355212981240771]

(-&gt; {:prng-name :xoroshiro128
     :seed s}
    prng
    (draw-ints 3 0 10))
;; [0 1 9]

(draw-ints p 3 0 10)
;; [0 1 9]
</code></pre>
<p>After some numbers have been drawn, you can ask the <code>prng</code> to come back to its original seed. So the next drawings return the same values.</p>
<pre><code class="language-clojure">(def p (prng {:prng-name :xoroshiro128}))

(draw-ints p 3 0 10)
;; [0 1 9]

(draw-ints p 3 0 10)
;; 2 9 1

(-&gt; p
    reset
    (draw-ints 3 0 10))
;; [0 1 9]
</code></pre>
<p><code>prng</code> are based on some mathematical series and are not perfectly random. It may happen that they are in some local pattern. If you have a <code>prng</code> and would like to continue to use it but not be dependant on the previous position in the series, you can use jump function.</p>
<pre><code class="language-clojure">(-&gt;
 (prng {:prng-name :xoroshiro128})
 jump
 rnd)
;; -8854234698690209532
</code></pre>
<p>The <code>rnd-range</code> function returns the range of data:</p>
<pre><code class="language-clojure">(-&gt;
 (prng {:prng-name :xoroshiro128})
 rnd-range)
;; [-9223372036854775808 9223372036854775807]
</code></pre>
<h1><a href="#registry" id="registry"></a>Registry</h1>
<p>The <code>automaton-optimization</code> library is shipped with some already implemented prng :</p>
<ul>
<li><code>xoroshiro128</code> which is a proxy for the excellent <code>xoroshito</code> library.</li>
</ul>
<pre><code class="language-clojure">(require '[automaton-optimization.prng :as opt-prng])

(-&gt; (opt-prng/xoroshiro128)
    opt-prng/rnd)
</code></pre>
<ul>
<li><code>built-in</code> which leverages the <code>prng</code> shipped with the platform executing your Clojure code (java, javascript, …). The creation of the built-in A test is not added for that one as it should not be called more than once, as only one global instance exists. An exception is thrown if you however try to call it twice.</li>
</ul>
<h1><a href="#creates-a-new-prng" id="creates-a-new-prng"></a>Creates a new PRNG</h1>
<p>Note that you can easily use your own <code>prng</code> as soon as you implement the <code>automaton-optimization.randomness.prng</code> protocol.</p>
<p>Only functions defined in the <code>PRNG</code> protocol are required, and all other functions of the namespace and <code>automaton-optimization</code> will be able to use this prng.</p>
<pre><code class="language-clojure">(require '[automaton-optimization.prng.stateless :as opt-prng-stateless]
         '[automaton-optimization.prng :as opt-prng])

(defrecord rest-api [min max]
  opt-prng-stateless/PRNGStateless
    (jump [this] (slurp "http://www.randomnumberapi.com/api/v1.0/random?min=" min "&amp;max=" max "&amp;count=100"))
    (rnd-range [_] [min max])
    (seed [_] nil)
    (peek-rnd [_]
      (-&gt;&gt; (slurp "http://www.randomnumberapi.com/api/v1.0/random?min=" min "&amp;max=" max "&amp;count=1")
           (re-find #"(\d+)")
           first
           Integer/parseInt))
    (next [this] this))

(-&gt; (-&gt;rest-api 0 100)
    opt-prng-stateless/peek-rnd)

(def extended-registry
  (-&gt; opt-prng/prng-registry
      (assoc :rest-api (fn [{:keys [min max]}]
                            (-&gt;rest-api min max)))))

(opt-prng/prng {:prng-name :rest-api
                :min 12 :max 18
                :registry extended-registry})
;; {:min 12, :max 18}
</code></pre>
</div></div></div></body></html>